{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Sophia\\\\Downloads\\\\Spring 2025\\\\Capstone Project\\\\CampusConnect_1\\\\capstone-project-campusconnect-team\\\\src\\\\pages\\\\MapNavigation.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useCallback } from \"react\";\nimport '../pages/App.css'; // Adjust the path if necessary\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconsole.log(\"MapNavigation re-rendered\");\nconst MapNavigation = ({\n  destination,\n  userLocation,\n  travelMode,\n  onRouteCalculated\n}) => {\n  _s();\n  const mapRef = useRef(null);\n  const directionsServiceRef = useRef(null);\n  const directionsRendererRef = useRef(null);\n  const mapInstanceRef = useRef(null);\n  const originMarkerRef = useRef(null);\n  const destinationMarkerRef = useRef(null);\n\n  //initalize map & directions services only once \n  useEffect(() => {\n    console.log(\"Initializing map...\");\n    if (!window.google || !window.google.maps) {\n      console.error(\"Google Maps API not loaded.\");\n      return;\n    }\n    if (!mapInstanceRef.current) {\n      mapInstanceRef.current = new window.google.maps.Map(mapRef.current, {\n        zoom: 16,\n        center: userLocation || destination,\n        disableDefaultUI: false // Prevents UI flickering\n      });\n      console.log(\"Map initialized:\", mapInstanceRef.current);\n\n      // Initialize DirectionsService and DirectionsRenderer only once\n      directionsServiceRef.current = new window.google.maps.DirectionsService();\n      directionsRendererRef.current = new window.google.maps.DirectionsRenderer({\n        suppressMarkers: true // Prevents automatic markers (fixes flickering)\n      });\n      directionsRendererRef.current.setMap(mapInstanceRef.current);\n    }\n  }, []);\n\n  // Ensure markers are created only once and update their positions\n  useEffect(() => {\n    if (!mapInstanceRef.current) return;\n\n    // **Use AdvancedMarkerElement Instead of Deprecated google.maps.Marker**\n    const {\n      AdvancedMarkerElement\n    } = google.maps.marker || {};\n    if (!originMarkerRef.current && userLocation) {\n      originMarkerRef.current = new AdvancedMarkerElement({\n        position: userLocation,\n        map: mapInstanceRef.current,\n        title: \"Your Location\",\n        text: \"A\"\n      });\n    } else if (originMarkerRef.current) {\n      originMarkerRef.current.position = userLocation;\n    }\n    if (!destinationMarkerRef.current && destination) {\n      destinationMarkerRef.current = new AdvancedMarkerElement({\n        position: destination,\n        map: mapInstanceRef.current,\n        title: \"Destination\",\n        text: \"B\"\n      });\n    } else if (destinationMarkerRef.current) {\n      destinationMarkerRef.current.position = destination;\n    }\n  }, [userLocation, destination]); // Only update markers if location changes\n\n  //     // Cleanup function to avoid memory leaks\n  //     return () => {\n  //         if (directionsRendererRef.current) {\n  //             directionsRendererRef.current.setMap(null);\n  //         }\n  //     };\n  // }, [userLocation, destination]);//only rerun if userLocation or destination changes\n\n  // Calculate and display the route\n  // âœ… Optimize route calculation\n  const calculateRoute = useCallback(() => {\n    if (!userLocation || !destination || !directionsServiceRef.current || !directionsRendererRef.current) {\n      return;\n    }\n    console.log(\"ðŸ“ Calculating route...\");\n    const request = {\n      origin: userLocation,\n      destination: destination,\n      travelMode: window.google.maps.TravelMode[travelMode]\n    };\n    directionsServiceRef.current.route(request, (result, status) => {\n      if (status === window.google.maps.DirectionsStatus.OK) {\n        directionsRendererRef.current.setDirections(result);\n\n        // Extract distance and duration\n        const route = result.routes[0].legs[0];\n        const distance = route.distance.text;\n        const duration = route.duration.text;\n\n        // Pass distance and duration back to the parent component\n        if (onRouteCalculated) {\n          onRouteCalculated({\n            [travelMode.toLowerCase()]: {\n              distance,\n              duration\n            }\n          });\n        }\n      } else {\n        console.error(\"Directions request failed:\", status);\n      }\n    });\n  }, [travelMode, userLocation, destination, onRouteCalculated]);\n\n  // âœ… Call route calculation when travelMode changes\n  useEffect(() => {\n    calculateRoute();\n  }, [calculateRoute]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: mapRef,\n    className: \"map-container\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 118,\n    columnNumber: 12\n  }, this);\n};\n_s(MapNavigation, \"pI1zCxOu3hXxTVLM02pOss1ZVx4=\");\n_c = MapNavigation;\nexport default MapNavigation;\nvar _c;\n$RefreshReg$(_c, \"MapNavigation\");","map":{"version":3,"names":["React","useEffect","useRef","useCallback","jsxDEV","_jsxDEV","console","log","MapNavigation","destination","userLocation","travelMode","onRouteCalculated","_s","mapRef","directionsServiceRef","directionsRendererRef","mapInstanceRef","originMarkerRef","destinationMarkerRef","window","google","maps","error","current","Map","zoom","center","disableDefaultUI","DirectionsService","DirectionsRenderer","suppressMarkers","setMap","AdvancedMarkerElement","marker","position","map","title","text","calculateRoute","request","origin","TravelMode","route","result","status","DirectionsStatus","OK","setDirections","routes","legs","distance","duration","toLowerCase","ref","className","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/Sophia/Downloads/Spring 2025/Capstone Project/CampusConnect_1/capstone-project-campusconnect-team/src/pages/MapNavigation.js"],"sourcesContent":["import React, { useEffect, useRef, useCallback } from \"react\";\nimport '../pages/App.css'; // Adjust the path if necessary\n\nconsole.log(\"MapNavigation re-rendered\");\nconst MapNavigation = ({ destination, userLocation, travelMode, onRouteCalculated }) => {\n    const mapRef = useRef(null);\n    const directionsServiceRef = useRef(null);\n    const directionsRendererRef = useRef(null);\n    const mapInstanceRef = useRef(null);\n    const originMarkerRef = useRef(null);\n    const destinationMarkerRef = useRef(null);\n\n\n    //initalize map & directions services only once \n    useEffect(() => {\n        console.log(\"Initializing map...\");\n        if (!window.google || !window.google.maps) {\n            console.error(\"Google Maps API not loaded.\");\n            return;\n        }\n\n        if (!mapInstanceRef.current) {\n            mapInstanceRef.current = new window.google.maps.Map(mapRef.current, {\n                zoom: 16,\n                center: userLocation || destination,\n                disableDefaultUI: false, // Prevents UI flickering\n            });\n\n        console.log(\"Map initialized:\", mapInstanceRef.current);\n\n        // Initialize DirectionsService and DirectionsRenderer only once\n        directionsServiceRef.current = new window.google.maps.DirectionsService();\n        directionsRendererRef.current = new window.google.maps.DirectionsRenderer({\n            suppressMarkers: true, // Prevents automatic markers (fixes flickering)\n        });\n            directionsRendererRef.current.setMap(mapInstanceRef.current);\n    }\n    }, []);\n\n        // Ensure markers are created only once and update their positions\n        useEffect(() => {\n            if (!mapInstanceRef.current) return;\n\n        // **Use AdvancedMarkerElement Instead of Deprecated google.maps.Marker**\n        const { AdvancedMarkerElement } = google.maps.marker || {};\n\n            if (!originMarkerRef.current && userLocation) {\n            originMarkerRef.current = new AdvancedMarkerElement({\n                position: userLocation,\n                map: mapInstanceRef.current,\n                title: \"Your Location\",\n                text: \"A\",\n            });\n            } else if (originMarkerRef.current) {\n                originMarkerRef.current.position = userLocation;\n            }\n\n            if (!destinationMarkerRef.current && destination) {\n                destinationMarkerRef.current = new AdvancedMarkerElement({\n                    position: destination,\n                    map: mapInstanceRef.current,\n                    title: \"Destination\",\n                    text: \"B\",\n                });\n            } else if (destinationMarkerRef.current) {\n                destinationMarkerRef.current.position = destination;\n            }\n\n        }, [userLocation, destination]); // Only update markers if location changes\n\n    //     // Cleanup function to avoid memory leaks\n    //     return () => {\n    //         if (directionsRendererRef.current) {\n    //             directionsRendererRef.current.setMap(null);\n    //         }\n    //     };\n    // }, [userLocation, destination]);//only rerun if userLocation or destination changes\n\n    // Calculate and display the route\n    // âœ… Optimize route calculation\n        const calculateRoute = useCallback(() => {\n            if (!userLocation || !destination || !directionsServiceRef.current || !directionsRendererRef.current) {\n                return;\n            }\n\n            console.log(\"ðŸ“ Calculating route...\");\n            const request = {\n                origin: userLocation,\n                destination: destination,\n                travelMode: window.google.maps.TravelMode[travelMode],\n            };\n\n            directionsServiceRef.current.route(request, (result, status) => {\n                if (status === window.google.maps.DirectionsStatus.OK) {\n                    directionsRendererRef.current.setDirections(result);\n\n                    // Extract distance and duration\n                    const route = result.routes[0].legs[0];\n                    const distance = route.distance.text;\n                    const duration = route.duration.text;\n\n                    // Pass distance and duration back to the parent component\n                    if (onRouteCalculated) {\n                        onRouteCalculated({[travelMode.toLowerCase()]: { distance, duration }});\n                    }\n                } else {\n                    console.error(\"Directions request failed:\", status);\n                }\n            });\n        \n        }, [travelMode, userLocation, destination, onRouteCalculated]);\n\n    // âœ… Call route calculation when travelMode changes\n    useEffect(() => {\n        calculateRoute();\n    }, [calculateRoute]);\n\n    return <div ref={mapRef} className=\"map-container\" />;\n};\n\nexport default MapNavigation;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}